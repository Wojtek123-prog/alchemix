<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALCHEMIX ‚àÜ - Laboratorium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f172a; color: #f8fafc; font-family: sans-serif; }
        .gradient-border { border: 2px solid; border-image: linear-gradient(to right, #3b82f6, #8b5cf6) 1; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-2xl mx-auto bg-slate-900 p-6 rounded-2xl shadow-2xl border border-slate-800">
        <h1 class="text-3xl font-bold text-center mb-2 text-blue-400 uppercase tracking-widest">ALCHEMIX ‚àÜ</h1>
        <p class="text-center text-slate-400 mb-6">Projekt Sp√≥≈Çki ALCHEMIAAI PROSTA S.A.</p>
        
        <div class="bg-slate-800 p-6 rounded-xl border-2 border-dashed border-slate-700 text-center mb-6" id="drop-zone">
            <input type="file" id="file-input" class="hidden" accept="video/*,image/*">
            <label for="file-input" class="cursor-pointer block">
                <div class="text-5xl mb-4">üìÅ</div>
                <p class="text-lg font-medium">Kliknij, aby wybraƒá film (np. BUSZEK.mp4)</p>
                <p id="file-name" class="text-blue-400 mt-2 font-mono italic"></p>
            </label>
        </div>

        <button id="analyze-btn" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 rounded-xl transition-all transform hover:scale-[1.02] shadow-lg uppercase tracking-wider">
            Uruchom Analizƒô Bieg≈Çej
        </button>

        <div id="status-area" class="mt-6 hidden text-center italic text-blue-300 animate-pulse">
            Bieg≈Ça analizuje nagranie... Proszƒô czekaƒá (52 sekundy to du≈ºy plik).
        </div>

        <div id="result-area" class="mt-8 space-y-4 hidden">
            <div class="p-4 bg-slate-950 rounded-lg border-l-4 border-blue-500">
                <h3 class="text-blue-400 font-bold mb-2 uppercase">Raport Bieg≈Çej:</h3>
                <div id="ai-response" class="whitespace-pre-wrap text-slate-300 leading-relaxed"></div>
            </div>
        </div>

        <div id="error-msg" class="mt-6 p-4 bg-red-900/30 border border-red-500 rounded-lg text-red-200 text-sm hidden text-center">
            Backend jeszcze nie odpowiada. Sprawd≈∫ ustawienia CORS lub adres URL.
        </div>
    </div>
  <script>
        const fileInput = document.getElementById('file-input');
        const fileName = document.getElementById('file-name');
        const analyzeBtn = document.getElementById('analyze-btn');
        const statusArea = document.getElementById('status-area');
        const resultArea = document.getElementById('result-area');
        const aiResponse = document.getElementById('ai-response');
        const errorMsg = document.getElementById('error-msg');

        // TW√ìJ AKTUALNY ADRES BACKENDU:
        const backendUrl = "https://alchemix-ai-backend-achhfubvhyateqag.westeurope-01.azurewebsites.net/api/analyze";

        fileInput.addEventListener('change', (e) => {
            if (e.target.files[0]) fileName.textContent = "Wybrano: " + e.target.files[0].name;
        });

        analyzeBtn.addEventListener('click', async () => {
            if (!fileInput.files[0]) { alert("Najpierw wybierz plik!"); return; }

            analyzeBtn.disabled = true;
            statusArea.classList.remove('hidden');
            resultArea.classList.add('hidden');
            errorMsg.classList.add('hidden');

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            try {
                const response = await fetch(backendUrl, {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) throw new Error("B≈ÇƒÖd po≈ÇƒÖczenia");

                const data = await response.json();
                aiResponse.textContent = data.analysis || "Bieg≈Ça nie mog≈Ça sformu≈Çowaƒá wniosk√≥w.";
                resultArea.classList.remove('hidden');
            } catch (err) {
                console.error(err);
                errorMsg.classList.remove('hidden');
            } finally {
                statusArea.classList.add('hidden');
                analyzeBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
